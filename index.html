<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alfa Ponsel TV Online</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <style>
        body { background: #0a0a0a; color: #fff; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; }
        .sticky-nav { position: sticky; top: 0; z-index: 999; background: #111; padding: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.8); }
        .video-wrapper { width: 100%; aspect-ratio: 16/9; background: #000; }
        .video-js { width: 100% !important; height: 100% !important; }
        .search-container { padding: 10px; }
        #search { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #333; background: #222; color: #fff; box-sizing: border-box; font-size: 16px; }
        .channel-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; padding: 15px; }
        .channel-card { background: #1a1a1a; border-radius: 12px; padding: 10px; text-align: center; cursor: pointer; border: 1px solid #222; transition: 0.2s; }
        .channel-card:active { background: #ff9800; transform: scale(0.95); }
        .channel-card img { width: 50px; height: 50px; object-fit: contain; margin-bottom: 8px; border-radius: 5px; background: #fff; padding: 2px; }
        .channel-name { font-size: 11px; font-weight: 600; line-height: 1.2; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .group-label { font-size: 9px; color: #aaa; margin-bottom: 4px; display: block; text-transform: uppercase; letter-spacing: 0.5px; }
    </style>
</head>
<body>

<div class="sticky-nav">
    <div class="video-wrapper">
        <video id="tv-player" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="auto" playsinline></video>
    </div>
    <div class="search-container">
        <input type="text" id="search" placeholder="Cari channel (Moji, Sky, Astro...)" autocomplete="off">
    </div>
</div>

<div class="channel-grid" id="list-container">
    </div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/videojs-contrib-dash/dist/videojs-dash.min.js"></script>

<script>
    const player = videojs('tv-player');
    const m3uUrl = 'https://github.com/maulanaisna/NontonTV/raw/refs/heads/main/maulanaisna.m3u';
    let allChannels = [];

    async function loadChannels() {
        try {
            const response = await fetch(m3uUrl);
            const text = await response.text();
            const lines = text.split('\n');
            
            let current = {};
            lines.forEach(line => {
                line = line.trim();
                if (line.startsWith('#EXTINF')) {
                    const info = line.split(',')[1];
                    const logo = line.match(/tvg-logo="([^"]+)"/)?.[1] || '';
                    const group = line.match(/group-title="([^"]+)"/)?.[1] || 'Lainnya';
                    current = { name: info, logo: logo, group: group };
                } else if (line.startsWith('http')) {
                    // Cek jika ada parameter DRM dengan tanda pipa |
                    const parts = line.split('|');
                    current.url = parts[0];
                    allChannels.push(current);
                    current = {};
                }
            });
            render(allChannels);
        } catch (err) {
            console.error("Gagal memuat M3U", err);
        }
    }

    function render(data) {
        const container = document.getElementById('list-container');
        container.innerHTML = '';
        data.forEach(item => {
            const card = document.createElement('div');
            card.className = 'channel-card';
            card.innerHTML = `
                <span class="group-label">${item.group}</span>
                <img src="${item.logo}" onerror="this.src='https://via.placeholder.com/50?text=TV'">
                <div class="channel-name">${item.name}</div>
            `;
            card.onclick = () => {
                let type = 'application/x-mpegURL'; // Default HLS
                if (item.url.includes('.mpd')) type = 'application/dash+xml';
                
                player.src({ src: item.url, type: type });
                player.play();
                window.scrollTo({top: 0, behavior: 'smooth'});
            };
            container.appendChild(card);
        });
    }

    document.getElementById('search').oninput = (e) => {
        const query = e.target.value.toLowerCase();
        const filtered = allChannels.filter(c => 
            c.name.toLowerCase().includes(query) || 
            c.group.toLowerCase().includes(query)
        );
        render(filtered);
    };

    loadChannels();
</script>
</body>
</html>

</html>
